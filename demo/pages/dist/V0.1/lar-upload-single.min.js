!function(e){function i(n){if(o[n])return o[n].exports;var l=o[n]={i:n,l:!1,exports:{}};return e[n].call(l.exports,l,l.exports,i),l.l=!0,l.exports}var o={};i.m=e,i.c=o,i.d=function(e,o,n){i.o(e,o)||Object.defineProperty(e,o,{configurable:!1,enumerable:!0,get:n})},i.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(o,"a",o),o},i.o=function(e,i){return Object.prototype.hasOwnProperty.call(e,i)},i.p="",i(i.s=31)}({0:function(e,i){e.exports=window.$},1:function(e,i){(function(i){e.exports=i}).call(i,{})},31:function(e,i,o){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=o(0),l=o.n(n);window.$=l.a,function(e){"function"==typeof define&&o(1)?define(["jquery"],e):e(jQuery)}(function(e){var i={swf:baseUrl+"/lib/webuploader/Uploader.swf",server:FileUpdateUrl+"/sword?SwordControllerName=fileUploadChunkController",resize:!1,nameFields:{id:"fileId",name:"fileName",path:"filePath"},chunked:!0,onSuccess:null,isManage:!1,accept:{extensions:"gif,jpg,jpeg,bmp,png,tiff,doc,docx,xls,xlsx,ppt,pptx,pdf,mp4,flv,avi,wmv,rmvb,mov,mpg,wma,mp3,wav,zip,rar,7z",mimeTypes:"image/*,application/vnd.ms-excel.12,application/vnd.ms-word.document.12,application/vnd.ms-powerpoint.12,application/pdf,application/vnd.ms-excel,application/vnd.ms-powerpoint,application/msword,video/*,application/vnd.rn-realmedia-vbr,audio/*,application/zip,application/x-rar-compressed,application/x-7z-compressed",title:"全部文件"},fileSingleSizeLimit:null};e.fn.larUploadSingle=function(i){return o[i]?o[i].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof i&&i?void e.error("SingleMethods "+i+" does not exist on jQuery.larUploadSingle"):o.init.apply(this,arguments)};var o={init:function(n){var l=e.extend({},i,n);return this.each(function(){var i=e(this),n=i.data("larUploadSingle");console.log(n),n||e(this).data("larUploadSingle",{target:i,options:l}),i=o._renderUI(i,l),l.pick=i.find(".single-upload .choose-file")[0],o._loadUploader(i,l)})},getVal:function(){var i=e(this),o={};return i.find(".single-oper input").each(function(e,i){o[i.name]=i.value}),o},setData:function(i){var o=e(this);e.isEmptyObject(i)||(o.find(".single-oper input").each(function(o,n){e(n).val(i[n.id])}),o.find(".single-upload").hide(),o.find(".single-oper").show(),o.find(".single-oper div a").text(o.find('.single-oper input[class="fields-name"]').val()),o.find(".single-oper div a").attr("href",URL_FILE_SERVER+o.find('.single-oper input[class="fields-path"]').val()),o.find(".single-oper div a").attr("target","_blank"))},_renderUI:function(i,o){var n=[],l=o;return i.addClass("lar-upload-single"),n.push('<div  class="single-upload input-group">                                                            '),n.push('\t<div class="choose-file">                                                          '),n.push('\t\t<input type="text" class="form-control" placeholder="点击选择文件"/>                '),n.push("\t</div>                                                                                "),n.push('\t<span class="input-group-addon">                                                    '),n.push('\t\t<i class="glyphicon glyphicon-cloud-upload"></i>                                '),n.push('\t\t<i class="glyphicon glyphicon-upload" style="cursor:pointer" title="上传"></i>   '),n.push("\t</span>                                                                                "),n.push('\t<div class="file-info"></div>                                                           '),n.push("</div>                                                                                   "),n.push('<div class="single-progress">                                                         '),n.push('\t<div class="progress progress-striped active">                                         '),n.push('\t\t<div class="progress-bar" role="progressbar" style="width: 0%"></div>               '),n.push("\t</div>                                                                                "),n.push("</div>                                                                                   "),n.push('<div  class="single-oper input-group">                                                            '),n.push('\t<div class="form-control">                                                        '),n.push('\t\t<a href="#"></a>                                                       '),l.nameFields&&l.nameFields.id&&n.push('\t<input type="hidden" class="fields-id" id="'+l.nameFields.id+'" name="'+l.nameFields.id+'" />         '),l.nameFields&&l.nameFields.name&&n.push('\t<input type="hidden" class="fields-name" id="'+l.nameFields.name+'" name="'+l.nameFields.name+'" />         '),l.nameFields&&l.nameFields.path&&n.push('\t<input type="hidden" class="fields-path" id="'+l.nameFields.path+'" name="'+l.nameFields.path+'" />         '),n.push("\t</div>                                                        "),n.push('\t<span class="input-group-addon">                                                  '),n.push('\t\t<i class="glyphicon glyphicon-remove" style="cursor:pointer" title="删除"></i>               '),n.push("\t</span>                                                                                "),n.push("</div>                                                                                  "),i.append(n.join("")),i.$upload=e(".single-upload",i),i.$chooseFile=e(".single-upload .choose-file",i),i.$cloud=e(".single-upload .glyphicon-cloud-upload",i),i.$uploadIcon=e(".single-upload .glyphicon-upload",i).hide(),i.$uploadIcon.click(function(){i.uploader.upload()}),i.$fileInfo=e(".single-upload .file-info",i).hide(),i.$progress=e(".single-progress",i).hide(),i.$oper=e(".single-oper",i).hide(),i.$remove=e(".single-oper .glyphicon-remove",i),i.$remove.click(function(){i.uploader.reset(),i.$oper.hide(),i.$chooseFile.find("input")[0].value="",i.$oper.find("input").val(""),i.$uploadIcon.hide(),i.$cloud.show(),i.$upload.show()}),i},_loadUploader:function(e,i){var n=i;n.chunked&&o._register(e),e.uploader=WebUploader.create(i),e.uploader.on("beforeFileQueued",function(i){e.uploader.reset()}),e.uploader.on("fileQueued",function(i){e.$chooseFile.find("input")[0].value=i.name,e.$cloud.hide(),e.$uploadIcon.show(),i.larProgress=e.$progress.find('div[class="progress-bar"]')}),e.uploader.on("uploadBeforeSend",function(e,i,o){i.chunkSize=this.options.chunkSize,i.md5=e.file.larFileMd5,i.filePath=e.file.larFilePath}),e.uploader.on("uploadStart",function(i){e.$upload.hide(),e.$progress.show()}),e.uploader.on("uploadProgress",function(i,o){e.$progress.find(".progress-bar").css("width",Math.floor(100*o)+"%").html(Math.floor(100*o)+"%")}),e.uploader.on("uploadSuccess",function(i){e.$progress.hide(),e.$oper.show(),e.$oper.find("div a").text(i.name),e.$oper.find(".fields-id").val(i.larFileId),e.$oper.find(".fields-name").val(i.name),e.$oper.find(".fields-path").val(i.larFilePath),n.onSuccess&&n.onSuccess.call(e)}),e.uploader.on("uploadError",function(e){console.log("error")})},_unRegister:function(){WebUploader.Uploader.unRegister("beforeSendFile"),WebUploader.Uploader.unRegister("beforeSend"),WebUploader.Uploader.unRegister("afterSendFile")},_register:function(i){o._unRegister();var n=null;WebUploader.Uploader.register({name:"beforeSendFile","before-send-file":function(i){var o=WebUploader.Deferred(),l=((new Date).getTime(),this.owner);return l.md5File(i.source).progress(function(e){i.larProgress.css("width",Math.floor(100*e)+"%").html("MD5  "+Math.floor(100*e)+"%")}).fail(function(){o.reject()}).then(function(a){e.ajax({type:"POST",url:FileUpdateUrl+"/sword/fileUpload/beforeSendFile",dataType:"json",autoWrap:!1,data:{md5:a,fileFullName:i.name,fileMiddleDir:l.options.fileMiddleDir,fileSize:i.size,isManage:l.options.isManage,isSearchFlag:!0},success:function(e){"noConfig"==e.model.status?(Util.alert("未找到附件配置，中断上传."),o.reject()):(i.larFileMd5=a,i.larFileId=e.model.data.id,i.larFilePath=e.model.data.filePath,"completed"===e.model.status?l.skipFile(i):n=e.model.data,o.resolve())}})}),o.promise()}}),WebUploader.Uploader.register({name:"beforeSend","before-send":function(i){var o=WebUploader.Deferred();return n.chunks?!function(){return e(n.chunks).each(function(e,o){if(o.chunk==i.chunk)return!0}),!1}()?o.resolve():o.reject():o.resolve(),o.promise()}}),WebUploader.Uploader.register({name:"afterSendFile","after-send-file":function(i){e.ajax({type:"POST",url:FileUpdateUrl+"/sword/fileUpload/afterSendFile",dataType:"json",autoWrap:!1,data:{id:i.larFileId},success:function(e){e.model.success}})}})}}})}});